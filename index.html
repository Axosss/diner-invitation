<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Natxoss Israeli Dinner</title>
    <link rel="icon" type="image/jpeg" href="./src/assets/images/icon.jpeg">
    <style>
        @font-face {
            font-family: 'Snell Roundhand';
            src: url('./src/assets/fonts/SnellRoundhand.ttc') format('truetype');
        }

        @font-face {
            font-family: 'STIX Two Text';
            src: url('./src/assets/fonts/STIXTwoText.ttf') format('truetype');
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'STIX Two Text', serif;
            background-color: #ffffff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Envelope container for 3D flip */
        .envelope-container {
            perspective: 2000px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 900px;
            height: 650px;
        }

        /* Envelope styling */
        .envelope {
            width: 100%;
            height: 100%;
            background: #ffffff;
            display: grid;
            place-content: center;
            position: relative;
            border: none;
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            transform-style: preserve-3d;
            transition: transform 1.5s ease, background 1s ease, box-shadow 1s ease;
            transform: rotateY(180deg);
        }

        .envelope.fade-out {
            background: transparent;
            box-shadow: none;
        }

        .envelope.fade-out::after {
            opacity: 0;
            transition: opacity 1s ease;
        }

        .envelope.fade-out .envelope-back,
        .envelope.fade-out .envelope-lid,
        .envelope.fade-out .envelope-lid-secondary,
        .envelope.fade-out .wax-seal,
        .envelope.fade-out .wax-seal-back {
            opacity: 0;
            transition: opacity 1s ease;
        }

        .envelope-container.flipped .envelope {
            transform: rotateY(0deg);
        }

        .envelope::after {
            content: '';
            position: absolute;
            inset: 0;
            border-top: 234px solid transparent;
            border-right: 450px solid #f5f5f5;
            border-bottom: 416px solid #f5f5f5;
            border-left: 450px solid #f5f5f5;
            transition: opacity 1s ease;
        }

        /* Back of envelope */
        .envelope-back {
            position: absolute;
            inset: 0;
            background: #ffffff;
            backface-visibility: hidden;
            transform: rotateY(180deg);
            z-index: 5;
            border: none;
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 1s ease;
        }

        /* Stamp on back */
        .stamp {
            position: absolute;
            top: 40px;
            right: 60px;
            width: 207.6px;
            height: 156px;
            background-image: url('./src/assets/images/stamp.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* Names on back of envelope */
        .envelope-back-text {
            text-align: center;
        }

        .envelope-back-name {
            font-family: 'Snell Roundhand', cursive;
            font-size: 70px;
            color: #44749C;
            display: block;
        }

        .envelope-back-ampersand {
            font-family: 'Snell Roundhand', cursive;
            font-size: 37px;
            color: #44749C;
            display: block;
        }

        .card-wrapper {
            perspective: 1000px;
            transform: rotate(-90deg);
            z-index: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            width: 600px;
            height: auto;
            background-color: #fff;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s ease-in-out;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-front,
        .card-back {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .card-back {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform: rotateY(180deg);
        }

        /* Blur overlay */
        .blur-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(
                to bottom,
                rgba(252, 246, 235, 0.05) 0%,
                rgba(252, 246, 235, 0.15) 20%,
                rgba(252, 246, 235, 0.05) 40%
            );
            z-index: 999;
        }

        .blur-overlay.hidden {
            display: none;
        }

        /* Open envelope button */
        .open-envelope-button {
            position: fixed;
            top: calc(50% + 380px);
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(65, 105, 225, 0.9);
            color: #fcf6eb;
            border: none;
            border-radius: 50px;
            padding: 20px 40px;
            font-family: 'STIX Two Text', serif;
            font-size: 20px;
            letter-spacing: 2px;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .open-envelope-button:hover {
            background-color: rgba(72, 118, 255, 0.95);
            transform: translate(-50%, -50%) scale(1.05);
        }

        .open-envelope-button.hidden {
            display: none;
        }

        /* Control buttons */
        .control-buttons {
            position: fixed;
            top: 20px;
            left: 20px;
            display: none;
            gap: 15px;
            z-index: 1000;
        }

        .control-buttons.visible {
            display: flex;
        }

        .control-button {
            background-color: rgba(68, 116, 156, 0.5);
            border: none;
            border-radius: 50px;
            cursor: not-allowed;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.6);
            font-family: 'STIX Two Text', serif;
            font-size: 16px;
            letter-spacing: 1px;
            pointer-events: none;
        }

        .control-button.enabled {
            pointer-events: auto;
            cursor: pointer;
            background-color: rgba(68, 116, 156, 0.9);
            color: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .control-button.enabled:hover {
            background-color: rgba(80, 130, 170, 0.95);
            transform: scale(1.05);
        }

        .music-button {
            padding: 12px 16px;
        }

        /* Music icon and play/pause */
        .music-icon-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .play-pause-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pause-bars {
            display: flex;
            gap: 4px;
        }

        .pause-bar {
            width: 3px;
            height: 16px;
            background-color: #fff;
            border-radius: 1px;
        }

        .play-triangle {
            width: 0;
            height: 0;
            border-left: 12px solid #fff;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            margin-left: 2px;
        }

        .music-note-icon {
            font-size: 20px;
        }

        /* Flip card icon and text */
        .flip-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flip-icon svg {
            width: 100%;
            height: 100%;
        }

        /* Calendar button icon */
        .calendar-icon {
            font-size: 20px;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .calendar-button {
            display: none;
            padding: 12px 20px;
            font-size: 16px;
        }

        .calendar-button .button-text-short {
            min-width: auto;
            width: auto;
        }

        .calendar-button.visible {
            display: flex;
            animation: subtle-pulse 3s ease-in-out infinite;
        }

        @keyframes subtle-pulse {
            0%, 100% {
                transform: scale(1);
            }
            5% {
                transform: scale(1.05);
            }
            10% {
                transform: scale(1);
            }
            15% {
                transform: scale(1.05);
            }
            20%, 100% {
                transform: scale(1);
            }
        }

        /* Calendar CTA Tooltip */
        .calendar-tooltip {
            position: fixed;
            background-color: rgba(68, 116, 156, 0.7);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-family: 'STIX Two Text', serif;
            font-size: 14px;
            letter-spacing: 1px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            opacity: 0;
            pointer-events: none;
            white-space: nowrap;
            transition: opacity 0.5s ease;
        }

        .calendar-tooltip.show {
            opacity: 1;
            animation: tooltip-pulse 2s ease-in-out infinite;
        }

        @keyframes tooltip-pulse {
            0%, 100% {
                transform: translate(-50%, 0) scale(1);
            }
            50% {
                transform: translate(-50%, 0) scale(1.05);
            }
        }

        .calendar-tooltip::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
        }

        /* FlÃ¨che vers le haut (tooltip en dessous du bouton - desktop) */
        .calendar-tooltip.arrow-up::before {
            top: -8px;
            border-bottom: 8px solid rgba(68, 116, 156, 0.7);
        }

        /* FlÃ¨che vers le bas (tooltip au-dessus du bouton - mobile) */
        .calendar-tooltip.arrow-down::before {
            bottom: -8px;
            border-top: 8px solid rgba(68, 116, 156, 0.7);
        }

        /* Button text variations */
        .button-text-short {
            display: none;
            white-space: nowrap;
        }

        .button-text-full {
            display: inline;
            white-space: nowrap;
        }

        /* Card back content styling */
        .card-back .save-the-date-card {
            border: 9pt solid #44749C;
            padding: 0;
            background-color: #fffdf9;
            background-image: url('https://www.transparenttextures.com/patterns/fabric-of-squares.png');
            background-blend-mode: multiply;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.6),
                        0 12px 30px rgba(0,0,0,0.25);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card-back-title {
            font-family: 'Snell Roundhand', cursive;
            font-size: 58px;
            color: #44749C;
            text-align: center;
            margin: 0 0 1.5rem 0;
            font-weight: normal;
            padding-top: 3rem;
        }

        .card-back-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .program-events-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            padding: 0 90px;
            flex: 1;
            justify-content: center;
        }

        .program-event-item {
            text-align: center;
        }

        .program-event-date {
            font-family: 'STIX Two Text', serif;
            font-size: 19px;
            color: #44749C;
            display: block;
            margin-bottom: 0.5rem;
            font-weight: normal;
            letter-spacing: 2px;
        }

        .program-event-title {
            font-family: 'Snell Roundhand', cursive;
            font-size: 40px;
            color: #44749C;
            display: block;
            font-weight: 300;
            font-style: italic;
        }

        .program-event-location {
            font-family: 'STIX Two Text', serif;
            font-size: 16px;
            color: #44749C;
            display: block;
            margin-top: 0.5rem;
            font-weight: normal;
            letter-spacing: 1px;
        }

        .card-back .special-day-logo {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
            padding-bottom: 3rem;
        }

        .card-back .special-day-logo img {
            height: 54px;
            width: auto;
        }

        /* Animation automatique */
        .envelope.opened .card-wrapper {
            animation: show-card 2s 2.5s forwards;
        }

        .envelope.opened .envelope-lid-secondary {
            animation: open-lid 1s 1.5s forwards, open-lid-stacking 500ms 1.5s forwards;
        }

        .envelope.opened .wax-seal {
            animation: seal-with-lid 1s 1.5s forwards;
        }

        .envelope.opened .wax-seal-back {
            animation: seal-back-with-lid 1s 1.5s forwards;
        }

        @keyframes show-card {
            0% {
                transform: translateY(0) rotate(-90deg);
                z-index: -1;
            }
            40% {
                transform: translateY(-50%) rotate(-90deg);
                z-index: -1;
            }
            60% {
                transform: translateY(-50%) rotate(0deg);
                z-index: 10;
            }
            100% {
                transform: translateY(0) rotate(0deg);
                z-index: 10;
            }
        }

        @keyframes open-lid {
            0% {
                transform: rotateX(0deg);
            }
            100% {
                transform: rotateX(180deg);
            }
        }

        @keyframes open-lid-stacking {
            50% {
                z-index: 1;
            }
            100% {
                z-index: -1;
            }
        }

        @keyframes seal-with-lid {
            0% {
                transform: translate(-50%, -50%) rotateX(0deg);
                transform-origin: 50% -177.5%;
                opacity: 1;
                z-index: 2;
            }
            50% {
                transform: translate(-50%, -50%) rotateX(90deg);
                transform-origin: 50% -177.5%;
                opacity: 1;
                z-index: 2;
            }
            51% {
                transform: translate(-50%, -50%) rotateX(90deg);
                transform-origin: 50% -177.5%;
                opacity: 0;
                z-index: 2;
            }
            60% {
                z-index: 2;
            }
            61% {
                z-index: -2;
            }
            70% {
                opacity: 0;
                z-index: -2;
            }
            100% {
                transform: translate(-50%, -50%) rotateX(180deg);
                transform-origin: 50% -177.5%;
                opacity: 0;
                z-index: -2;
            }
        }

        @keyframes seal-back-with-lid {
            0% {
                transform: translate(-50%, -50%) rotateX(0deg);
                transform-origin: 50% -177.5%;
                opacity: 0;
                z-index: 1;
            }
            50% {
                transform: translate(-50%, -50%) rotateX(90deg);
                transform-origin: 50% -177.5%;
                opacity: 0;
                z-index: 1;
            }
            51% {
                transform: translate(-50%, -50%) rotateX(90deg);
                transform-origin: 50% -177.5%;
                opacity: 1;
                z-index: 1;
            }
            60% {
                z-index: 1;
            }
            61% {
                z-index: -1;
            }
            100% {
                transform: translate(-50%, -50%) rotateX(180deg);
                transform-origin: 50% -177.5%;
                opacity: 1;
                z-index: -1;
            }
        }

        /* Envelope lid styling */
        .envelope-lid {
            position: absolute;
            inset: 0;
            z-index: 1;
            transition: opacity 1s ease;
        }

        .envelope-lid::before,
        .envelope-lid::after {
            content: '';
            position: absolute;
            top: 0;
            width: 0px;
            background-color: transparent;
        }

        .envelope-lid::before {
            left: 0;
            height: 480px;
            transform: rotate(-63.1deg);
            transform-origin: top left;
        }

        .envelope-lid::after {
            right: 0;
            height: 480px;
            transform: rotate(63.1deg);
            transform-origin: top right;
        }

        .envelope-lid-secondary {
            background: #f5f5f5;
            clip-path: polygon(50% 36%, 0 0, 100% 0);
            transition: transform 1s, opacity 1s ease;
            transform-origin: top;
        }

        /* Wax Seal */
        .wax-seal {
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: opacity 1s ease;
            width: 100px;
            height: 100px;
            z-index: 2;
            opacity: 1;
            background-image: url('./src/assets/images/wax-seal.png');
            background-size: contain;
            background-repeat: no-repeat;
        }

        /* Wax Seal Back (empreinte) */
        .wax-seal-back {
            position: absolute;
            top: 35%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            z-index: 1;
            opacity: 0;
            background-image: url('./src/assets/images/wax-seal-back.png');
            background-size: contain;
            background-repeat: no-repeat;
            transition: opacity 0.5s ease;
        }

        .wax-seal-back.visible {
            opacity: 1;
        }

        /* Save the Date Card Content */
        .save-the-date-card {
            max-width: 600px;
            width: 100%;
            border: 9pt solid #44749C;
            padding: 0;
            background-color: #fffdf9;
            background-image: url('https://www.transparenttextures.com/patterns/fabric-of-squares.png');
            background-blend-mode: multiply;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.6),
                        0 12px 30px rgba(0,0,0,0.25);
        }

        .special-day-title {
            font-family: 'Snell Roundhand', cursive;
            font-size: 58px;
            color: #44749C;
            text-align: center;
            margin: 0 0 1.5rem 0;
            font-weight: normal;
            padding-top: 3rem;
        }

        .names-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.2rem;
            margin-bottom: 0.3rem;
        }

        .welcome-name {
            font-family: 'Snell Roundhand', cursive;
            font-size: 70px;
            color: #44749C;
            display: block;
        }

        .welcome-ampersand {
            font-family: 'Snell Roundhand', cursive;
            font-size: 37px;
            color: #44749C;
            display: block;
        }

        .welcome-subtitle {
            font-family: 'STIX Two Text', serif;
            font-size: 19px;
            color: #44749C;
            margin: 0 0 1.5rem 0;
            font-weight: normal;
            letter-spacing: 2px;
            text-align: center;
        }

        .special-day-dates {
            font-family: 'Snell Roundhand', cursive;
            font-size: 40px;
            color: #44749C;
            text-align: center;
            margin: 0 0 0.5rem 0;
            font-weight: 300;
            font-style: italic;
        }

        .special-day-location-city {
            font-family: 'STIX Two Text', serif;
            font-size: 19px;
            color: #44749C;
            text-align: center;
            margin: 0 0 0.3rem 0;
            font-weight: normal;
            letter-spacing: 2px;
        }

        .special-day-location {
            font-family: 'STIX Two Text', serif;
            font-size: 19px;
            color: #44749C;
            text-align: center;
            margin: 0 0 2rem 0;
            font-weight: normal;
            letter-spacing: 2px;
        }

        .special-day-text {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding: 0 90px;
        }

        .special-day-text p {
            font-family: 'STIX Two Text', serif;
            font-size: 16px;
            color: #44749C;
            line-height: 1.8;
            margin: 0;
            text-align: center;
            letter-spacing: 2px;
        }

        .special-day-logo {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
            padding-bottom: 3rem;
        }

        .special-day-logo img {
            height: 54px;
            width: auto;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                overflow: hidden;
                min-height: 100vh;
                max-height: 100vh;
            }

            .envelope-container {
                width: 85.5vw;
                height: auto;
                aspect-ratio: 900 / 650;
                left: 50%;
                transform: translate(-50%, -50%);
            }

            .envelope {
                width: 100%;
                height: 100%;
            }

            .envelope::after {
                border-top: calc(85.5vw * 195 / 900) solid transparent;
                border-right: calc(85.5vw / 2) solid #f5f5f5;
                border-bottom: calc(85.5vw * 455 / 900) solid #f5f5f5;
                border-left: calc(85.5vw / 2) solid #f5f5f5;
            }

            .envelope-lid::before,
            .envelope-lid::after {
                height: calc(85.5vw * 480 / 900);
                width: 0px;
            }

            .envelope-lid-secondary {
                clip-path: polygon(50% 30.15%, 0 0, 100% 0);
            }

            .card-wrapper {
                transition: all 1s ease;
                transform: rotate(-90deg) scale(0.45);
            }

            .envelope.opened .card-wrapper {
                animation: show-card-mobile 2s 2.5s forwards;
            }

            @keyframes show-card-mobile {
                0% {
                    transform: translateY(0) rotate(-90deg) scale(0.45);
                    z-index: -1;
                }
                40% {
                    transform: translateY(-50%) rotate(-90deg) scale(0.45);
                    z-index: -1;
                }
                60% {
                    transform: translateY(-50%) rotate(0deg) scale(0.45);
                    z-index: 10;
                }
                100% {
                    transform: translateY(-10pt) rotate(0deg) scale(0.9);
                    z-index: 10;
                }
            }

            .stamp {
                width: 115px;
                height: 86px;
                top: 10px;
                right: 20px;
            }

            .envelope-back-name {
                font-size: 40px;
            }

            .envelope-back-ampersand {
                font-size: 24px;
            }

            .wax-seal {
                width: 70px;
                height: 70px;
                top: 35%;
            }

            .wax-seal-back {
                width: 70px;
                height: 70px;
                top: 35%;
            }

            .envelope.opened .wax-seal {
                animation: seal-with-lid-mobile 1s 1.5s forwards;
            }

            .envelope.opened .wax-seal-back {
                animation: seal-back-with-lid-mobile 1s 1.5s forwards;
            }

            @keyframes seal-with-lid-mobile {
                0% {
                    transform: translate(-50%, -50%) rotateX(0deg);
                    transform-origin: 50% -110%;
                    opacity: 1;
                    z-index: 2;
                }
                50% {
                    transform: translate(-50%, -50%) rotateX(90deg);
                    transform-origin: 50% -102.5%;
                    opacity: 1;
                    z-index: 2;
                }
                51% {
                    opacity: 0;
                    z-index: 2;
                }
                60% {
                    z-index: 2;
                }
                61% {
                    z-index: -2;
                }
                70% {
                    opacity: 0;
                    z-index: -2;
                }
                100% {
                    transform: translate(-50%, -50%) rotateX(180deg);
                    transform-origin: 50% -95%;
                    opacity: 0;
                    z-index: -2;
                }
            }

            @keyframes seal-back-with-lid-mobile {
                0% {
                    transform: translate(-50%, -50%) rotateX(0deg);
                    transform-origin: 50% -110%;
                    opacity: 0;
                    z-index: 1;
                }
                50% {
                    transform: translate(-50%, -50%) rotateX(90deg);
                    transform-origin: 50% -102.5%;
                    opacity: 0;
                    z-index: 1;
                }
                51% {
                    transform: translate(-50%, -50%) rotateX(90deg);
                    transform-origin: 50% -102.5%;
                    opacity: 1;
                    z-index: 1;
                }
                60% {
                    z-index: 1;
                }
                61% {
                    z-index: -1;
                }
                100% {
                    transform: translate(-50%, -50%) rotateX(180deg);
                    transform-origin: 50% -95%;
                    opacity: 1;
                    z-index: -1;
                }
            }

            .card {
                width: 85.5vw !important;
                max-width: 85.5vw !important;
            }

            .save-the-date-card {
                width: 100% !important;
                max-width: 100% !important;
                border-width: 5pt;
            }

            .special-day-title {
                font-size: 38px;
                padding-top: 2rem;
            }

            .welcome-name {
                font-size: 48px;
            }

            .welcome-ampersand {
                font-size: 32px;
            }

            .welcome-subtitle {
                font-size: 14px;
            }

            .special-day-dates {
                font-size: 30px;
            }

            .special-day-location-city {
                font-size: 14px;
            }

            .special-day-location {
                font-size: 14px;
            }

            .special-day-text {
                padding: 0 1.5rem;
            }

            .special-day-text p {
                font-size: 13px;
                padding-top: 30px;
            }

            .special-day-logo {
                padding-bottom: 1.5rem;
                margin-top: 1rem;
            }

            .special-day-logo img {
                height: 38px;
            }

            .control-buttons {
                top: auto;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
                gap: 10px;
            }

            .control-button {
                padding: 10px 19px;
                font-size: 13px;
            }

            .music-button {
                padding: 10px 12px;
            }

            .play-pause-icon {
                width: 16px;
                height: 16px;
            }

            .pause-bar {
                width: 2.5px;
                height: 14px;
            }

            .play-triangle {
                border-left: 10px solid #fff;
                border-top: 6px solid transparent;
                border-bottom: 6px solid transparent;
            }

            .music-note-icon {
                font-size: 16px;
            }

            .flip-icon {
                width: 18px;
                height: 18px;
            }

            .calendar-icon {
                font-size: 16px;
                width: 16px;
                height: 16px;
            }

            .calendar-button {
                padding: 10px 19px;
                font-size: 13px;
            }

            .calendar-button .button-text-short {
                min-width: auto;
                width: auto;
            }

            .button-text-short {
                display: inline;
            }

            .button-text-full {
                display: none;
            }

            .card-back-title {
                font-size: 38px;
                padding-top: 2rem;
                margin-bottom: 1.5rem;
            }

            .program-events-list {
                padding: 0 1.5rem;
                gap: 1.5rem;
            }

            .program-event-date {
                font-size: 14px;
            }

            .program-event-title {
                font-size: 30px;
            }

            .program-event-location {
                font-size: 13px;
            }

            .card-back .special-day-logo {
                padding-bottom: 1.5rem;
                margin-top: 1rem;
            }

            .card-back .special-day-logo img {
                height: 38px;
            }

            .card-back .save-the-date-card {
                border-width: 5pt;
            }

            .open-envelope-button {
                padding: 15px 30px;
                font-size: 16px;
                top: calc(50% + 252px);
            }

            .calendar-tooltip {
                font-size: 12px;
                padding: 10px 16px;
            }
        }

        /* CSS Confetti animation */
        .confetti-piece {
            position: fixed;
            width: 40px;
            height: 40px;
            pointer-events: none;
            z-index: 1500;
        }

        @keyframes confetti-explosion {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        /* Rain effect */
        .rain-piece {
            position: fixed;
            pointer-events: none;
            z-index: -1;
            opacity: 0.8;
        }

        .rain-piece img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        @keyframes rain-fall {
            0% {
                transform: translateY(-500px) rotate(0deg);
                opacity: 0;
            }
            5% {
                opacity: 0.8;
            }
            95% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(calc(100vh + 200px)) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Audio elements -->
    <audio id="backgroundMusic" loop>
        <source src="./src/assets/music/Tel Aviv - Omer Adam (Feat. Arisa).mp3" type="audio/mpeg">
    </audio>
    <audio id="envelopeOpenSound">
        <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_ba0c25972f.mp3?filename=paper-flip-2-102220.mp3" type="audio/mpeg">
    </audio>

    <!-- Blur overlay -->
    <div class="blur-overlay" id="blurOverlay"></div>

    <!-- Open envelope button -->
    <button class="open-envelope-button" id="openEnvelopeButton">OPEN ENVELOPE</button>

    <!-- Control buttons -->
    <div class="control-buttons" id="controlButtons">
        <!-- Music button -->
        <button class="control-button music-button" id="musicButton">
            <div class="music-icon-container">
                <div class="play-pause-icon" id="playPauseIcon">
                    <div class="pause-bars">
                        <div class="pause-bar"></div>
                        <div class="pause-bar"></div>
                    </div>
                </div>
                <div class="music-note-icon">â™ª</div>
            </div>
        </button>

        <!-- Flip card button -->
        <button class="control-button" id="flipButton">
            <div class="flip-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12h18M3 12l4-4m-4 4 4 4M21 12l-4-4m4 4-4 4"/>
                </svg>
            </div>
            <span class="button-text-full">Flip Card</span>
            <span class="button-text-short">Flip</span>
        </button>

        <!-- Add to Calendar button -->
        <button class="control-button calendar-button" id="addToCalendarButton">
            <span class="calendar-icon">ðŸ“…</span>
            <span class="button-text-full">Add to Calendar</span>
            <span class="button-text-short">+</span>
        </button>

    </div>

    <!-- Calendar CTA Tooltip -->
    <div class="calendar-tooltip" id="calendarTooltip">ðŸ‘‰ Save the date!</div>

    <div class="envelope-container">
        <div class="envelope">
            <div class="envelope-back">
                <div class="stamp"></div>
                <div class="envelope-back-text">
                    <span class="envelope-back-name">Natxoss dinner party</span>
                </div>
            </div>
            <div class="envelope-lid"></div>
            <div class="envelope-lid envelope-lid-secondary"></div>
            <div class="wax-seal-back"></div>
            <div class="wax-seal"></div>
            <div class="card-wrapper">
            <div class="card" id="flipCard">
                <!-- Front of card -->
                <div class="card-front">
                    <div class="save-the-date-card">
                        <h1 class="special-day-title">Israeli Dinner</h1>

                        <div class="names-container">
                            <span class="welcome-name">Natxoss</span>
                        </div>

                        <h2 class="welcome-subtitle">Invite you to gain 3 pounds</h2>

                        <p class="special-day-dates">Saturday November 8th</p>
                        <p class="special-day-location-city">24 rue du Boccador</p>
                        <p class="special-day-location-city" style="margin-bottom: 0.8rem;">Paris 8</p>
                        <p class="special-day-location" style="font-style: italic; margin-bottom: 0.1rem;">Code: 3101,</p>
                        <p class="special-day-location" style="font-style: italic; margin-bottom: 0.1rem;">Inter. 31,</p>
                        <p class="special-day-location" style="font-style: italic;">4th floor</p>

                        <div class="special-day-text">
                            <p>Falafel in love with this dinner</p>
                        </div>

                        <div class="special-day-logo">
                            <img src="./src/assets/logos/Program_logo.svg" alt="K&M Logo">
                        </div>
                    </div>
                </div>

                <!-- Back of card -->
                <div class="card-back">
                    <div class="save-the-date-card">
                        <div class="card-back-content">
                            <h1 class="card-back-title">The Menu</h1>

                            <div class="program-events-list">
                                <div class="program-event-item">
                                    <span class="program-event-title">Starters</span>
                                    <span class="program-event-location">Israeli salad, hummus, tahini, pita fresh from the oven</span>
                                </div>

                                <div class="program-event-item">
                                    <span class="program-event-title">Main</span>
                                    <span class="program-event-location">Falafel party with all the toppings</span>
                                </div>

                                <div class="program-event-item">
                                    <span class="program-event-title">Dessert</span>
                                    <span class="program-event-location">Sweet surprise from Tel Aviv</span>
                                </div>
                            </div>
                        </div>

                        <div class="special-day-logo">
                            <img src="./src/assets/logos/Program_logo.svg" alt="K&M Logo">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <script>
        let autoFlipTimeout = null;
        let hasFlipped = false;
        let musicPlaying = false;
        let sealBackTimeout = null;
        let sealBackHidden = false;

        // ===== CONFETTI ANIMATIONS =====

        // Animation: Explosion CSS Pure
        function testExplosionConfetti() {
            const numberOfParticles = 50;
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;

            for (let i = 0; i < numberOfParticles; i++) {
                createExplosionParticle(centerX, centerY);
            }
        }

        function createExplosionParticle(x, y) {
            const particle = document.createElement('div');
            particle.className = 'confetti-piece';

            // CrÃ©er une image SVG
            particle.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 600 692.82">
                    <path d="M 47.631413,492.11477 552.36859,492.11491 300,54.999953 Z M 300,637.81981 552.36851,200.70493 47.631403,200.70481 Z"
                          fill="none" stroke="#44749C" stroke-width="55"/>
                </svg>
            `;

            particle.style.left = x + 'px';
            particle.style.top = y + 'px';

            const angle = Math.random() * Math.PI * 2;
            const velocity = 200 + Math.random() * 400;
            const vx = Math.cos(angle) * velocity;
            const vy = Math.sin(angle) * velocity;
            const rotationSpeed = (Math.random() - 0.5) * 720;
            const size = 20 + Math.random() * 30;

            particle.style.width = size + 'px';
            particle.style.height = size + 'px';

            document.body.appendChild(particle);

            const duration = 2000 + Math.random() * 1000;
            const startTime = Date.now();

            function animate() {
                const currentTime = Date.now();
                const elapsed = currentTime - startTime;
                const progress = elapsed / duration;

                if (progress >= 1) {
                    particle.remove();
                    return;
                }

                const gravity = 500;
                const currentX = x + vx * (elapsed / 1000);
                const currentY = y + vy * (elapsed / 1000) + 0.5 * gravity * Math.pow(elapsed / 1000, 2);
                const rotation = rotationSpeed * (elapsed / 1000);
                const opacity = 1 - progress;

                particle.style.transform = `translate(-50%, -50%) translate(${currentX - x}px, ${currentY - y}px) rotate(${rotation}deg)`;
                particle.style.opacity = opacity;

                requestAnimationFrame(animate);
            }

            animate();
        }

        // ===== END CONFETTI ANIMATIONS =====

        // ===== RAIN EFFECT =====
        const rainImages = [
            './src/assets/background-rain/18914_0.webp',
            './src/assets/background-rain/555.webp',
            './src/assets/background-rain/8bfb02ad63c0296b3c359798888622f3.webp',
            './src/assets/background-rain/AmIsraelHai.webp',
            './src/assets/background-rain/cotedjxe3cdtbnsm8evm.webp',
            './src/assets/background-rain/h5qp9su6ubbohho7mrtv.webp',
            './src/assets/background-rain/hallah.webp',
            './src/assets/background-rain/hummous.webp',
            './src/assets/background-rain/hummous2.webp',
            './src/assets/background-rain/jepnqub5bj5gad7fj33z.webp',
            './src/assets/background-rain/jewishuwerethiscool.webp',
            './src/assets/background-rain/maguen.webp',
            './src/assets/background-rain/ou2qbnxzq7fwx4qbymzb.webp',
            './src/assets/background-rain/pink.webp',
            './src/assets/background-rain/s9ea4xilihugq2sbpypt.webp',
            './src/assets/background-rain/shalom_pin.webp',
            './src/assets/background-rain/st,small,507x507-pad,600x600,f8f8f8 Background Removed.u4.webp',
            './src/assets/background-rain/st,small,507x507-pad,600x600,f8f8f8 Background Removed.webp',
            './src/assets/background-rain/ukpatpouhwnnjui2pmfj.webp'
        ];

        let rainInterval = null;
        let currentRainIndex = 0;

        function createRainPiece() {
            const piece = document.createElement('div');
            piece.className = 'rain-piece';

            // SÃ©lectionner l'image suivante dans l'ordre
            const selectedImage = rainImages[currentRainIndex];
            currentRainIndex = (currentRainIndex + 1) % rainImages.length;

            const img = document.createElement('img');
            img.src = selectedImage;
            piece.appendChild(img);

            // Taille fixe constante (rÃ©duit de 20%)
            const size = 112;
            piece.style.width = size + 'px';
            piece.style.height = size + 'px';

            // Position horizontale alÃ©atoire
            piece.style.left = Math.random() * 100 + '%';

            // DurÃ©e alÃ©atoire de chute (plus lente)
            const duration = 8 + Math.random() * 6; // Entre 8 et 14 secondes
            piece.style.animation = `rain-fall ${duration}s linear forwards`;

            document.body.appendChild(piece);

            // Supprimer l'Ã©lÃ©ment aprÃ¨s l'animation
            setTimeout(() => {
                piece.remove();
            }, duration * 1000);
        }

        function startRainEffect() {
            // CrÃ©er une nouvelle piÃ¨ce toutes les 1500ms
            rainInterval = setInterval(() => {
                createRainPiece();
            }, 1500);
        }

        function stopRainEffect() {
            if (rainInterval) {
                clearInterval(rainInterval);
                rainInterval = null;
            }
        }

        // ===== END RAIN EFFECT =====

        // Fonction pour gÃ©nÃ©rer le fichier iCalendar
        function generateICS() {
            const events = [
                {
                    title: "Israeli Party at Natxoss",
                    location: "24 rue du boccador, 75008 Paris France",
                    description: "Code : 3101, Interphone 31, 4eme etage",
                    startDate: "20251108",
                    endDate: "20251108",
                    startTime: "200000",
                    endTime: "230000"
                }
            ];

            let icsContent = [
                'BEGIN:VCALENDAR',
                'VERSION:2.0',
                'PRODID:-//Natxoss Israeli Dinner//EN',
                'CALSCALE:GREGORIAN',
                'METHOD:PUBLISH',
                'X-WR-CALNAME:Natxoss Israeli Dinner',
                'X-WR-TIMEZONE:Europe/Paris'
            ];

            events.forEach(event => {
                icsContent.push(
                    'BEGIN:VEVENT',
                    `DTSTART:${event.startDate}T${event.startTime}`,
                    `DTEND:${event.endDate}T${event.endTime}`,
                    `SUMMARY:${event.title}`,
                    `LOCATION:${event.location}`,
                    `DESCRIPTION:${event.description}`,
                    `UID:${event.startDate}-${Math.random().toString(36).substring(7)}@wedding.com`,
                    'STATUS:CONFIRMED',
                    'SEQUENCE:0',
                    'END:VEVENT'
                );
            });

            icsContent.push('END:VCALENDAR');

            return icsContent.join('\r\n');
        }

        // Fonction pour tÃ©lÃ©charger le fichier ICS
        function downloadICS() {
            const icsContent = generateICS();
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'NatxossIsraeliDinner.ics';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Fonction pour flipper la carte
        function toggleCardFlip() {
            const card = document.getElementById('flipCard');
            const calendarButton = document.getElementById('addToCalendarButton');
            const sealBack = document.querySelector('.wax-seal-back');

            card.classList.toggle('flipped');

            // Faire disparaÃ®tre le seal-back au premier flip
            if (card.classList.contains('flipped') && !sealBackHidden) {
                sealBackHidden = true;
                if (sealBackTimeout) {
                    clearTimeout(sealBackTimeout);
                }
                sealBack.style.transition = 'opacity 1s ease';
                sealBack.style.setProperty('opacity', '0', 'important');
            }

            // Afficher le bouton Calendar au premier flip
            if (card.classList.contains('flipped')) {
                calendarButton.classList.add('visible');
                calendarButton.classList.add('enabled');

                // Afficher le tooltip dÃ¨s que le bouton apparaÃ®t
                setTimeout(() => {
                    const tooltip = document.getElementById('calendarTooltip');

                    // Positionner le tooltip par rapport au bouton calendar
                    const buttonRect = calendarButton.getBoundingClientRect();

                    const buttonCenterX = buttonRect.left + buttonRect.width / 2;

                    // VÃ©rifier si on est sur mobile (largeur < 768px)
                    const isMobile = window.innerWidth <= 768;

                    let tooltipTop;
                    if (isMobile) {
                        // Sur mobile : au-dessus du bouton
                        const tooltipRect = tooltip.getBoundingClientRect();
                        tooltipTop = buttonRect.top - tooltipRect.height - 15;
                        tooltip.classList.remove('arrow-up');
                        tooltip.classList.add('arrow-down');
                    } else {
                        // Sur desktop : en dessous du bouton
                        tooltipTop = buttonRect.bottom + 15; // 15px d'espace sous le bouton
                        tooltip.classList.remove('arrow-down');
                        tooltip.classList.add('arrow-up');
                    }

                    tooltip.style.left = buttonCenterX + 'px';
                    tooltip.style.top = tooltipTop + 'px';
                    tooltip.style.transform = 'translate(-50%, 0)';

                    tooltip.classList.add('show');

                    // Masquer le tooltip aprÃ¨s 6 secondes
                    setTimeout(() => {
                        tooltip.classList.remove('show');
                    }, 6000);
                }, 100);
            }

            // Annuler le flip automatique si l'utilisateur a cliquÃ©
            if (!hasFlipped) {
                hasFlipped = true;
                if (autoFlipTimeout) {
                    clearTimeout(autoFlipTimeout);
                }
            }
        }

        // Fonction pour configurer MediaSession (pour le lecteur iOS)
        function setupMediaSession() {
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: 'Natxoss Israeli Dinner',
                    artist: 'Axoss',
                    album: 'Tel Aviv 2025',
                    artwork: [
                        { src: './src/assets/images/icon.jpeg', sizes: '512x512', type: 'image/jpeg' }
                    ]
                });

                navigator.mediaSession.setActionHandler('play', () => {
                    const audio = document.getElementById('backgroundMusic');
                    audio.play();
                    musicPlaying = true;
                    document.getElementById('playPauseIcon').innerHTML = `
                        <div class="pause-bars">
                            <div class="pause-bar"></div>
                            <div class="pause-bar"></div>
                        </div>
                    `;
                });

                navigator.mediaSession.setActionHandler('pause', () => {
                    const audio = document.getElementById('backgroundMusic');
                    audio.pause();
                    musicPlaying = false;
                    document.getElementById('playPauseIcon').innerHTML = '<div class="play-triangle"></div>';
                });
            }
        }

        // Fonction pour toggle la musique
        function toggleMusic() {
            const audio = document.getElementById('backgroundMusic');
            const playPauseIcon = document.getElementById('playPauseIcon');

            if (musicPlaying) {
                // Pause la musique
                audio.pause();
                musicPlaying = false;
                playPauseIcon.innerHTML = '<div class="play-triangle"></div>';
            } else {
                // Play la musique (brut, sans modification)
                audio.play().catch(err => {
                    console.log('Erreur lors de la lecture:', err);
                });
                musicPlaying = true;
                playPauseIcon.innerHTML = `
                    <div class="pause-bars">
                        <div class="pause-bar"></div>
                        <div class="pause-bar"></div>
                    </div>
                `;
            }
        }

        // Fonction pour ouvrir l'enveloppe
        function openEnvelope() {
            const openButton = document.getElementById('openEnvelopeButton');
            const blurOverlay = document.getElementById('blurOverlay');
            const controlButtons = document.getElementById('controlButtons');
            const flipButton = document.getElementById('flipButton');
            const musicButton = document.getElementById('musicButton');
            const audio = document.getElementById('backgroundMusic');
            const envelopeSound = document.getElementById('envelopeOpenSound');

            // DÃ©clencher l'effet confettis dÃ¨s le clic
            testExplosionConfetti();

            // Masquer le bouton d'ouverture et l'overlay de flou
            openButton.classList.add('hidden');
            blurOverlay.classList.add('hidden');

            // Afficher les boutons de contrÃ´le et activer le bouton musique immÃ©diatement
            controlButtons.classList.add('visible');
            musicButton.classList.add('enabled');

            // DÃ©marrer la musique immÃ©diatement (brut, sans modification)
            audio.play().then(() => {
                musicPlaying = true;
            }).catch(err => {
                console.log('Autoplay bloquÃ©');
                musicPlaying = false;
                document.getElementById('playPauseIcon').innerHTML = '<div class="play-triangle"></div>';
            });

            // Flip l'enveloppe
            setTimeout(() => {
                document.querySelector('.envelope-container').classList.add('flipped');
            }, 500);

            // Ouvrir l'enveloppe avec son
            setTimeout(() => {
                document.querySelector('.envelope').classList.add('opened');

                // Jouer le son d'ouverture
                envelopeSound.play().catch(err => {
                    console.log('Erreur lors de la lecture du son d\'ouverture:', err);
                });
            }, 2000);

            // Activer le bouton Flip quand la carte arrive en position finale
            setTimeout(() => {
                flipButton.classList.add('enabled');
            }, 4500);

            // Faire disparaÃ®tre l'enveloppe 5 secondes aprÃ¨s que la carte soit en position finale
            setTimeout(() => {
                document.querySelector('.envelope').classList.add('fade-out');
            }, 9500);

            // Faire disparaÃ®tre le seal-back aprÃ¨s 5 secondes s'il n'y a pas eu de flip
            // L'animation se termine Ã  2.5s, donc on attend 5s de plus = 7.5s
            sealBackTimeout = setTimeout(() => {
                if (!sealBackHidden) {
                    const sealBack = document.querySelector('.wax-seal-back');
                    sealBackHidden = true;
                    sealBack.style.transition = 'opacity 1s ease';
                    sealBack.style.setProperty('opacity', '0', 'important');
                }
            }, 7500);

            // Flip automatique Ã  11 secondes
            autoFlipTimeout = setTimeout(() => {
                if (!hasFlipped) {
                    toggleCardFlip();
                    hasFlipped = true;
                }
            }, 11000);

            // DÃ©marrer l'effet de pluie aprÃ¨s 15 secondes
            setTimeout(() => {
                startRainEffect();
            }, 15000);
        }

        // Initialisation au chargement de la page
        window.addEventListener('load', () => {
            const card = document.getElementById('flipCard');
            const openButton = document.getElementById('openEnvelopeButton');
            const flipButton = document.getElementById('flipButton');
            const musicButton = document.getElementById('musicButton');
            const addToCalendarButton = document.getElementById('addToCalendarButton');

            // Configurer MediaSession pour le lecteur iOS
            setupMediaSession();

            // Ajouter l'Ã©vÃ©nement au bouton d'ouverture
            openButton.addEventListener('click', openEnvelope);

            // Ajouter l'Ã©vÃ©nement de clic uniquement au bouton flip
            flipButton.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleCardFlip();
            });

            // Ajouter l'Ã©vÃ©nement au bouton musique
            musicButton.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleMusic();
            });

            // Ajouter l'Ã©vÃ©nement au bouton "Add to Calendar"
            addToCalendarButton.addEventListener('click', (e) => {
                e.stopPropagation();
                downloadICS();
            });
        });
    </script>
</body>
</html>
